# 2019 Android Testing Inquiry Area

## 아장아장 안린이의 안드로이드 테스트 첫걸음

* 결함을 사전에 발견할 수 있다.
    * 실제 행동이 일어나지 않더라도 개발 과정 중에 포착 가능
* 문서로서 작용
    * 작성자의 의도, 사용법, 주의 사항 등이 드러나게 되어 있음.
* 리팩토링에 대한 확신
    * 이전의 동작이 변경되지 않았음을 담보할 수 있는 장치
* 더 나은 구조를 유도
    * 역할 분담 및 나쁜 구조를 바꾸어줌.

* 안드로이드 기기가 아닌 다른 기기에서 돌리면 안드로이드 코드는 전부 예외를 낸다.
    * 이를 해결하기 위해서는 Mockito를 사용해서 Mocking을 해주면 된다.
    * 안드로이드 디펜던시를 걷어내는 방법도 존재한다.

* 테스트 코드를 전제조건, 동작, 예상 결과 3단계로 나누어서 한다.
    * 사고 표현에 용이하고 가독성 증가에 용이하다.
    * 모든 케이스를 다뤄야 베스트 프랙티스이다.
    * jacoco로 테스트 커버리지를 측정하여 하면 보기 좋다.
    * 각 케이스는 독립적으로 일을 해야 한다.

* UI 테스팅, 몽키 테스팅, Mockito 등의 키워드로 접근하면 좋다.

* **정리**: 안드로이드 테스트를 처음 시작하여 테스트의 장점부터 어떻게 시작하면 되고 어떻게 하면 되는지에 대한 발표였다.
* **느낀점**: 안드로이드 테스트를 어떻게 해야할지에 대한 갈피를 잡았다.

## JVM 상에서 통합테스트? 하기
* 전략은 JVM 상에서 추상화 되어 있는 UI를 검증하자는 것이었다.
* Mock View라는 가상의 View를 만들고 Mock Rest Api라는 가상의 Api를 만들었다.
    * 이렇게 하면 소프트웨어 비즈니스 룰에 따라 테스트 커버리지가 가능하다.
    * Mock View는 시나리오 결과로서 검증을 위한 용도이다.
    * Mock Rest Api는 그리고자 하는 시나리오를 위해 응답을 흉내내기 위한 용도이다.
* 테스트 코드는 같은 기능이라도 다른 상황을 생각하여 여러가지 테스트 코드를 작성해야하고 given, when, then와 같은 흐름으로 작성한다.
* 상태에 의한 검증이나 행위에 대한 검증을 하기 위해 여러가지의 시나리오를 작성한다.
* 통합 테스트는 QA보다 더 빨리 Debug를 할 수 있는 등의 장점이 있지만 Unit Test보다는 견고하지 못하다는 단점이 있다.
* 하지만 비용이 있는 만큼 가치있는 투자이며 속도가 빨라 안드로이드 테스팅을 했을 때보다 빠른 결과를 얻을 수 있다.

* **정리**: 단위 테스트가 아닌 프로그램의 전체 시나리오에 따른 통합 테스트를 하는 법에 대한 발표였다.
* **느낀점**: 테스트는 단위 테스트만 있는 줄 알았는데 단위 테스트보다는 견고하지 않지만 적절한 시나리오를 배치하여 테스트할 수 있는 통합테스트가 있다는 것을 알게 되어 좋았다.

## QA에서 직접 UI 테스트하기 위한 작업을 해보았다.
* Espresso Record가 베스트이긴 하지만 한번 실행한 폰이 아니면 오류가 난다는 문제점과 하나 하나에 sleep을 주어야 한다는 문제가 있었다.
* 그래서 QA 팀에서 사용하기에는 어려웠고 Ui Automator를 선택했는데 그 이유는 화면에서 보이는 텍스트를 찾기 가능하고 클릭할 수 있는 형태를 만들 수 있고, permission 체크도 가능하다는 점 때문이다.
* 하지만 계속해서 케이스가 추가 되면 라이브러리를 계속해서 업데이트를 해줘야 했다.
* 결국 이러한 이유들로 실패했다.
* 결론적으로는 개발을 모르는 사람에게 UI 테스트를 시키는 것은 어려운 일이다.
* 그래도 sleep을 해줘야 하는 문제점은 코루틴의 채널을 통한 비동기 처리로 해결하였다.

* **정리**: 개발을 어려워해 UI 테스트를 하기 어려운 QA 팀을 위한 UI 테스트 라이브러리를 만든 이야기이다.
* **느낀점**: 아무리 쓰기 편한 라이브러리라도 개발을 잘 모르는 사람이 쓰게 한다는 것은 정말 어렵다는 걸 알게 되었고 UI 테스트의 단점도 알게 되었다.

## Unit Test부터 UI Test까지
* 대학 소프트웨어 공학시간에 배워도 Unit Test의 중요성을 몰랐었지만 Retrofit이라는 새로운 기술을 배우면서 귀찮은 과정을 줄이기 위해 Unit Test를 시작하였다.
* Unit Test를 하다보니 의존성의 중요성을 알게 되어 DI를 해보기도 하는 기회도 생겼다.
* Unit Test 뿐만 아니라 회사에 들어가서 UI Automator로 UI 테스트도 하고 있다고 하신다.

* **정리**: 테스트를 한다는 것의 중요성과 접근 법 등을 발표자님의 스토리와 엮어낸 발표였다.
* **느낀점**: 나도 발표자님과 같은 방법으로 테스트에 접근해야겠다는 생각이 들었다.